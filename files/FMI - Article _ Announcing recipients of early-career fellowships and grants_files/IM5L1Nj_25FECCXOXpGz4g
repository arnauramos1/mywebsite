(()=>{var e={120:()=>{"use strict";const e=function(){},t=document.cookie&&document.cookie.indexOf("wv-debug=true")>-1;var n;function i(e,t){return function(){e.apply(t||this,[].concat.apply([this],arguments))}}function a(e,t,i){if(n!==e.hasAttributes&&e.hasAttributes()&&n!==e.attributes[t]&&e.attributes[t].value===i)return e;if(e.hasChildNodes()){const n=e.childNodes;for(let e=0;e<n.length;e++){let o=a(n[e],t,i);if(null!==o)return o}}return null}function o(e,t){r(e,t)||(e.className+=" "+t)}function l(e,t){if(!r(e,t))return;const n=e.className.split(" ");let i="";for(let e=0;e<n.length;e++){const a=n[e];a!==t&&(i+=a+" ")}e.className=i}function r(e,t){return e.className.split(" ").indexOf(t)>-1}function s(e,t){if(null!==d("wv-error"))return;const i=document.createElement("div");i.id=i.className="wv-error",i.innerHTML=e,document.body.appendChild(i),n!==t&&i.addEventListener("click",t)}function d(e){return document.getElementById(e)}function c(){t&&console.log.apply(console,arguments)}class h{constructor(){this.events={}}emit(e,t){const n=this;if(n.events[e])for(let i=0;i<n.events[e].length;i++)n.events[e][i].apply(this,t)}on(e,t){const n=this;void 0===n.events[e]?n.events[e]=[t]:n.events[e].push(t)}off(e){const t=this;if("string"==typeof eventName)return delete t.events[e];for(let n=0;n<e.length;n++)delete t.events[e[n]]}offAll(){this.events={}}}const u=document,p=window,g=["script","noscript","style","meta","iframe","figure","figcaption","title","option","form","label"],m="wv-load",f="wv-play",v="wv-pause",y="wv-loading";var E,_=!1;class b extends h{constructor(e){super();const t=this,n=p.wvWidget;t.element=e.element,t.audioElement=e.audioElement,t.preloadElement=e.preloadElement,t.preloadedText=p.wvData.text||e.text,E!==t.preloadedText&&t.preloadedText.length>0&&(t.preloadedText=t.preloadedText.replace(/\.(?=[^\s])/g,". ")),E!==e.appendButtonText&&(t.appendButtonText=e.appendButtonText),t.proxifiedOnAudioEnd=i(t.onAudioEnd,t),_=e.isDevelopment,t.fingerprint=function(){function e(){return Math.random().toString(16).slice(-4)}return e()+e()+e()+e()+e()+e()+e()+e()}(),t.loadPlayer(),t.loadInterval=null,n.on("start",i(t.playClick,t)),n.off("start")}loadPlayer(){const e=this,t=u.querySelector(".wv-button-placeholder");null!==t?t.append(e.createPlayButton()):e.element.insertBefore(e.createPlayElement(),e.element.firstChild),e.repositionPlayer()}unload(){const e=d(this.fingerprint);this.stopAudio(),null!==e&&e.parentElement.removeChild(e)}createPlayElement(){const e=this,t=p.wvData["widget-style"],n=u.createElement("div");let a="wv-circle",o="Read Content";return E!==t&&(E!==t.className&&(a=t.className),E!==t.contrast&&(a+=" "+t.contrast),E!==t.showTooltip&&!0===t.showTooltip&&(a+=" show-tooltip"),E!==t.tooltipText&&(o=t.tooltipText),E!==t.backgroundColor&&(n.style.backgroundColor=t.backgroundColor)),n.id=e.fingerprint,n.className="wv-wrapper "+a,a.indexOf("show-tooltip")>-1&&n.setAttribute("data-tooltip-text",o),e.playButton=u.createElement("div"),e.playButton.className=m,e.playButton.setAttribute("aria-label",o),e.playButton.setAttribute("role","button"),e.playButton.setAttribute("tabindex","0"),e.playButton.title=o,n.appendChild(e.playButton),e.playButton.addEventListener("click",i(e.playClick,this)),n}createPlayButton(){const e=this,t=p.wvData["widget-style"],n=u.createElement("a"),a=u.createElement("span");let o="wv-btn-default",l="Read Content";return E!==t&&(E!==t.className&&(o=t.className),E!==t.contrast&&(o+=" "+t.contrast),E!==t.buttonText&&(l=t.buttonText),E!==t.backgroundColor&&(n.style.backgroundColor=t.backgroundColor),E!==t.showTime&&!0===t.showTime&&E!==e.preloadedText&&(l=e.timeFromText(e.preloadedText)+" "+l)),E!==e.appendButtonText&&(l+=" "+e.appendButtonText),n.id=e.fingerprint,n.className+="wv-wrapper-button wv-ignore "+o,n.href="#",n.setAttribute("aria-label",l),n.title=l,e.playButton=u.createElement("div"),e.playButton.className=m,n.appendChild(e.playButton),l.length>0&&(a.textContent=l,n.appendChild(a)),n.addEventListener("click",i(e.playClick,this)),n}repositionPlayer(){let e;this.element.getBoundingClientRect().left<90&&(e=d(this.fingerprint),l(e,"wv-circle"),o(e,"wv-circle-small"))}playClick(e,t){const n=this,i=n.playButton;let a="";E!==t&&E!==t.preventDefault&&t.preventDefault(),r(i,m)?(a="play",n.startAudio()):r(i,f)?(a="resume",n.playAudio()):r(i,v)&&(a="pause",n.pauseAudio()),E!==p.wvData.onPlayClick&&p.wvData.onPlayClick(n.element.id||"",a)}startAudio(){const e=this,t=p.wvWidget;if(e.resetActivePlayers(),0===e.pendingTexts.length&&e.loadText(),0===e.pendingTexts.length)return console.error("Text is empty");e.audioElement.pause(),e.audioElement.currentTime>0&&(e.audioElement.currentTime=0),e.playbackRate=1,e.loadAudioForText(e.pendingTexts[e.activeIndex]),e.audioElement.addEventListener("ended",e.proxifiedOnAudioEnd),t.off(["stop","play","pause"]),t.on("stop",e.proxifiedOnAudioEnd),t.on("play",i(e.playClick,e)),t.on("pause",i(e.pauseAudio,e)),e.activeIndex++}playAudio(){const e=this;l(e.playButton,f),o(e.playButton,v),e.audioElement.play(),e.emit("play"),E!==p.wvData.onPlay&&p.wvData.onPlay(),p.wvWidget.setPlaying(!0)}pauseAudio(){const e=this;l(e.playButton,v),o(e.playButton,f),e.emit("pause"),e.audioElement.pause()}stopAudio(){const e=this;e.audioElement.pause(),e.pendingTexts&&(e.activeIndex=e.pendingTexts.length,e.activeAudioIndex=e.pendingAudios.length,e.onAudioEnd())}onTimeUpdateAudio(){const e=this;e.audioElement.duration-e.audioElement.currentTime<10&&!e.loadingAudio&&e.pendingTexts.length>0&&e.activeIndex<e.pendingTexts.length&&(c("loading next audio"),e.loadAudioForText(e.pendingTexts[e.activeIndex]),e.activeIndex++)}loadAudioForText(t){const a=this,r=_?"http://"+u.location.host:"https://websitevoice.com",s=t instanceof Array;let d,h=p.wvData||{},g=a.element.getAttribute("data-wv-lang")||h.language,f=a.element.getAttribute("data-wv-gender")||h.gender;if(""===t||s&&0===t.length)return console.error("Text is empty");s||(a.loadingAudio=!0,a.playingText=t,o(a.playButton,y),l(a.playButton,m));const v={wvData:JSON.stringify(h),page_url:u.location.href,widget_fingerprint:a.fingerprint,texts_count:a.textsLength};s?(v.text=t.join(h.id),v.download=!0,d=i(a.onDownloadAjaxLoad,a)):(v.text=t,v.text_index=a.activeIndex+1,d=i(a.onAjaxLoad,a)),v.text=v.text.replace(/(.)\n/g,"$1.\n"),v.text=v.text.replace(/\.\.\n/g,".\n"),E!==g&&(v.language=g),E!==f&&(v.gender=f),c(v.text),function(t){const i=new XMLHttpRequest;if(i.onload=t.onLoad||e,i.open(t.method||"GET",t.url,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onreadystatechange=function(e){const i=e.target;4===i.readyState&&200!==i.status&&n!==t.onError&&t.onError(i.status)},"POST"===t.method){i.setRequestHeader("Content-Type","application/x-www-form-urlencoded");let e="";for(const[n,i]of Object.entries(t.data))e+=encodeURIComponent(n)+"="+encodeURIComponent(i)+"&";i.send(e)}else i.send()}({url:r+"/text-to-speech",method:"POST",data:v,onLoad:d,onError:i(a.onAjaxError,a)})}loadText(){const e=this;let t,n,i=a(this.element,"data-wv","text"),o=!0,l="";null===i&&(o=!1,i=this.element),E!==e.preloadedText?l=e.preloadedText:null!==i&&(l=e.getTextFromElement(i,o)),l=l.replace(/@([a-z]|[0-9])+\.[a-z]{2,3}/gi,(e=>e.replace(".","~"))),l=l.replace(/[0-9]+\.[0-9]+/g,(e=>e.replace(".","~"))),l=l.replace(/\.”/g,"."),t=l.split(".").filter((e=>e.length>0)).map((e=>(e=(e=(e=e.replace(/[0-9]+~[0-9]+/g,(e=>e.replace("~",".")))).replace(/@([a-z]|[0-9])+~[a-z]{2,3}/gi,(e=>e.replace("~",".")))).replace(/\s{3,}/g,"\n")).trim()+".")),n="",t.map((t=>{n+=" "+t,n.length>=500&&(e.pendingTexts.push(n),n="")})),n.length>0&&e.pendingTexts.push(n),e.texts=e.pendingTexts.slice(),e.textsLength=e.pendingTexts.length}getTextFromChildren(e,t){let n="";if(E!==e.tagName&&g.indexOf(e.tagName.toLowerCase())>-1)return"";if(0===e.childNodes.length)-1===g.indexOf(e.parentNode.tagName.toLowerCase())&&(n=!0===t&&E!==e.textContent?e.textContent:e.innerText,E===n&&(n=e.textContent));else for(let i=0;i<e.childNodes.length;i++)Node.COMMENT_NODE!==e.childNodes[i].nodeType&&(n+=this.getTextFromChildren(e.childNodes[i],t));return n+(n.length>1?"\n":"")}getTextFromElement(e,t){if(null===e)return"";let n="";const i=u.createDocumentFragment();i.appendChild(e.cloneNode(!0));const a=i.querySelectorAll(".wv-ignore");for(let e=0;e<a.length;e++)a[e].parentNode.removeChild(a[e]);if(!i.hasChildNodes())return"";for(let e=0;e<i.childNodes.length;e++)n+=this.getTextFromChildren(i.childNodes[e],t).trim();return n.replace(/\n{3,}/g,"\n\n")}onAjaxLoad(e){const t=this;let n;try{n=JSON.parse(e.responseText)}catch(e){console.log(e),n=null}if(null===n||E===n.mp3)return t.onAjaxError(null,500),console.error("Missing json");l(t.playButton,y),o(t.playButton,v),t.emit("play"),t.pendingAudios.push(n.mp3),t.preloadElement.src=n.mp3,t.preloadElement.load(),t.loadInterval=setInterval(i((function(){const e=this;0===e.audioElement.currentTime&&(e.createAudio(),clearInterval(e.loadInterval),e.loadInterval=null,e.emit("textupdate",[e.playingText])),c("waiting to end current audio")}),t),300)}onAjaxError(e,t){let n;n=403===t?"The authorized site in your WebsiteVoice account doesn't match this current website. Please update it in your Websitevoice dashboard.":429===t?"Looks like you are loading audios too fast. Please wait some minutes, refresh the page, and try again.":"There was an error loading the audio, please refresh the page and try again or contact the website owner.",console.error("Error "+t+" when loading text to speech"),s(n)}onDownloadAjaxLoad(e){const t=u.createElement("a");let n,i;try{n=JSON.parse(e.responseText)}catch(e){console.log(e),n=null}if(null===n||E===n.mp3)return this.onAjaxError(null,500),console.error("Missing json");if(i=n.mp3,t.href=i,E!==t.download){let e=i.substring(i.lastIndexOf("/")+1,i.length);t.download=e}if(this.emit("audiodownloaded"),E!==u.createEvent){let e=u.createEvent("MouseEvents");return e.initEvent("click",!0,!0),t.dispatchEvent(e)}p.open(i,"_self")}createAudio(){const e=this;e.audioElement.src=e.pendingAudios[e.activeAudioIndex],e.audioElement.load(),e.audioElement.playbackRate=e.playbackRate;let t=e.audioElement.play();E!==t?t.then((function(){p.wvWidget.setPlaying(!0)})).catch(i(e.showAutoplayError,e)):(p.wvWidget.setPlaying(!0),E!==p.wvData.onPlay&&p.wvData.onPlay()),e.activeAudioIndex++,e.loadingAudio=!1}showAutoplayError(){s('Your browser prevents autoplay of audio. Please <a href="#" id="wv-allow-autoplay" title="Allow autoplay">click here to start the audio</a>.',i(this.authorizeAutoplay,this))}authorizeAutoplay(e,t){d("wv-error").style.display="none",this.playAudio(),t.preventDefault()}timeFromText(e){const t=.35*e.split(" ").length;return new Date(1e3*t).toISOString().substr(14,5).replace("00:","0:")}resetActivePlayers(){const e=this,t=u.querySelectorAll("."+f+", ."+v);e.texts=[],e.pendingTexts=[],e.pendingAudios=[],e.textsLength=0,e.activeIndex=0,e.activeAudioIndex=0;for(let e=0;e<t.length;e++)l(t[e],f),l(t[e],y),l(t[e],v),o(t[e],m);e.emit("reset"),e.audioElement.ontimeupdate=null,e.audioElement.ontimeupdate=i(e.onTimeUpdateAudio,e)}onAudioEnd(){const e=this;e.audioElement.pause(),e.audioElement.currentTime=0,p.wvWidget.setPlaying(!1),E!==p.wvData.onPlayEnd&&p.wvData.onPlayEnd(e.element.id||""),e.pendingTexts.length===e.activeIndex&&e.pendingAudios.length===e.activeAudioIndex&&(c("remove end event"),e.audioElement.removeEventListener("ended",e.proxifiedOnAudioEnd),l(e.playButton,v),o(e.playButton,m),e.emit("stop"))}onGlobalPlayClick(e){e.playingFingerprint===this.fingerprint&&this.playClick()}onGlobalPauseClick(e){this.onGlobalPlayClick(e)}onGlobalRewindClick(e){const t=this;if(e.playingFingerprint!==t.fingerprint)return;if(null!==t.loadInterval&&(t.activeIndex>1&&t.activeIndex--,clearInterval(t.loadInterval),t.loadInterval=null,t.loadingAudio=!1,t.pendingAudios.pop()),1===t.activeIndex)return void(t.audioElement.currentTime=0);t.activeIndex--,t.activeAudioIndex--,t.audioElement.src=t.pendingAudios[t.activeAudioIndex-1],t.audioElement.load(),t.audioElement.playbackRate=t.playbackRate;let n=t.audioElement.play();E!==n&&n.catch((function(){})),t.pendingAudios.pop(),t.emit("textupdate",[t.pendingTexts[t.activeIndex-1]])}onGlobalSpeedClick(e){const t=this;e.playingFingerprint===t.fingerprint&&(t.playbackRate=e.playbackRate,t.audioElement.playbackRate=e.playbackRate)}onGlobalDownloadClick(e){const t=this;if(e.playingFingerprint===t.fingerprint)return/(iP)/g.test(navigator.userAgent)?alert("Your device does not support file downloading. Please try again in desktop browser."):void t.loadAudioForText(t.texts)}}const T="wv-pc-play",N="wv-pc-pause",x='<div class="wv-audio"> Audio by <a href="https://websitevoice.com" title="WebsiteVoice" target="_blank">websitevoice.com</a></div>',A='<a href="#" id="wv-audio-download" title="Download audio">Download audio as mp3</a>',w=encodeURIComponent(`Listening to: ${document.title}`),C=encodeURIComponent(document.location.href),S=`<a id="wv-facebook-btn" target="_blank" class="wv-facebook-btn" href="https://www.facebook.com/sharer.php?u=${C}">&nbsp;</a><a id="wv-twitter-btn" target="_blank" class="wv-twitter-btn" href="https://twitter.com/intent/tweet?url=${C}&text=${w}&via=website_voice">&nbsp;</a>`;var L=document,I=window;class D extends h{constructor(e={}){super();const t=this;isNaN(e.package)||(t.package=e.package),t.professionalPackage=[2,5,6].includes(parseInt(t.package)),t.premiumPackage=[1,4].includes(parseInt(t.package)),t.allowExtraFeatures=t.professionalPackage||e.trialNotExpired,t.allowSocialIcons=t.package>0||e.trialNotExpired,t.playbackRate=1,t.controlTextId="wv-t-"+Math.random().toString(36).substring(7),t.buildPlayer(),t.playButton=d(T),t.rewindButton=d("wv-pc-rewind"),t.speedButton=d("wv-pc-speed"),t.controlText=d(t.controlTextId),t.shareIcons=d("wv-social-icons-container"),t.addEvents()}buildPlayer(){const e=this,t=L.createElement("div");let n=x,i="";e.allowExtraFeatures&&!0===I.wvData["enable-downloads"]?n=A:(e.professionalPackage||e.premiumPackage)&&(n=""),e.allowSocialIcons&&!0===I.wvData["enable-shares"]&&(i=S);const a=`\n      <div class="wv-container">\n        <div id="wv-player-controls" class="wv-player-controls">\n          <i id="wv-pc-rewind" aria-label="Rewind" role="button" tabindex="0" class="wv-pc-rewind">&nbsp;</i>\n          <i id="wv-pc-play" aria-label="Play" role="button" tabindex="0" class="wv-pc-play">&nbsp;</i>\n          ${e.allowExtraFeatures?'<span id="wv-pc-speed" aria-label="Speed" role="button" tabindex="0" class="wv-pc-speed">1x</span>':""}\n        </div>\n        <div id="${e.controlTextId}" class="${e.controlTextId}">${n}</div>\n        <div id="wv-social-icons-container" class="wv-social-icons">${i}</div>\n      </div>`;t.id="wv-player",t.className="wv-player wv-inactive",!0===I.wvData["player-disabled"]&&(t.className+=" wv-player-disabled"),t.innerHTML=a,e.player=t,L.body.appendChild(t)}reload(){const e=this;let t=x,n="";e.allowExtraFeatures&&!0===I.wvData["enable-downloads"]?t=A:e.professionalPackage&&(t=""),e.controlText.innerHTML=t,e.allowSocialIcons&&!0===I.wvData["enable-shares"]&&(n=S),e.shareIcons.innerHTML=n}addEvents(){const e=this;e.playButton.addEventListener("click",i(e.onPlayClick,e)),e.rewindButton.addEventListener("click",i(e.onRewindClick,e)),null!==e.speedButton&&e.speedButton.addEventListener("click",i(e.onSpeedClick,e)),e.controlText.addEventListener("click",i(e.onControlTextClick,e))}subscribeToWidget(e){const t=this;e.on("play",i(t.onPlay,t)),e.on("pause",i(t.onPause,t)),e.on("stop",i(t.onStop,t)),e.on("textupdate",i(t.onTextUpdate,t)),e.on("audiodownloaded",i(t.onAudioDownloaded,t)),t.on("globalplayclick",i(e.onGlobalPlayClick,e)),t.on("globalpauseclick",i(e.onGlobalPauseClick,e)),t.on("globalrewindclick",i(e.onGlobalRewindClick,e)),t.on("globalspeedclick",i(e.onGlobalSpeedClick,e)),t.on("globaldownloadclick",i(e.onGlobalDownloadClick,e))}unsubscribeFromWidget(e){e.offAll()}onPlay(e){const t=this;l(t.playButton,T),o(t.playButton,N),t.playbackRate=1,null!==t.speedButton&&(t.speedButton.textContent="1x"),void 0!==e&&(t.playingFingerprint=e.fingerprint)}onPause(){l(this.playButton,N),o(this.playButton,T)}onStop(){const e=this;l(e.playButton,N),o(e.playButton,T),l(e.player,"wv-active"),o(e.player,"wv-inactive"),e.playbackRate=1,null!==e.speedButton&&(e.speedButton.textContent="1x")}onReset(){l(this.playButton,N),o(this.playButton,T)}onTextUpdate(){const e=this;r(e.player,"wv-inactive")&&(o(e.player,"wv-active"),l(e.player,"wv-inactive"))}onAudioDownloaded(){this.controlText.innerHTML="Done"}onControlTextClick(e,t){"wv-audio-download"===t.target.id&&(this.controlText.innerHTML="Downloading, please wait...",this.emit("globaldownloadclick")),t.preventDefault()}onPlayClick(){const e=this;r(e.playButton,T)?(e.onPlay(),e.emit("globalpauseclick")):(e.onPause(),e.emit("globalplayclick"))}onRewindClick(){this.emit("globalrewindclick")}onSpeedClick(){const e=this;e.playbackRate+=.1,e.playbackRate>1.8&&(e.playbackRate=.8),e.speedButton.textContent=Math.round(10*e.playbackRate)/10+"x",e.emit("globalspeedclick")}}function k(e,t){if(!e||!e.documentElement)throw new Error("First argument to WVExtractor constructor should be a document object.");t=t||{},this._doc=e,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._debug=!!t.debug,this._maxElemsToParse=t.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=t.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=t.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(t.classesToPreserve||[]),this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug?this.log=function(){var e=["Reader: (WVExtractor) "].concat(arguments);console.log.apply(console,e)}:this.log=function(){}}k.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|foot|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,whitespace:/^\s*$/,hasContent:/\S$/},DIV_TO_P_ELEMS:["A","BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL","SELECT"],ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],_postProcessContent:function(e){this._fixRelativeUris(e),this._cleanClasses(e)},_removeNodes:function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n],a=i.parentNode;a&&(t&&!t.call(this,i,n,e)||a.removeChild(i))}},_replaceNodeTags:function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n];this._setNodeTag(i,t)}},_forEachNode:function(e,t){Array.prototype.forEach.call(e,t,this)},_someNode:function(e,t){return Array.prototype.some.call(e,t,this)},_everyNode:function(e,t){return Array.prototype.every.call(e,t,this)},_concatNodeLists:function(){var e=Array.prototype.slice,t=e.call(arguments).map((function(t){return e.call(t)}));return Array.prototype.concat.apply([],t)},_getAllNodesWithTag:function(e,t){return e.querySelectorAll?e.querySelectorAll(t.join(",")):[].concat.apply([],t.map((function(t){var n=e.getElementsByTagName(t);return Array.isArray(n)?n:Array.from(n)})))},_cleanClasses:function(e){var t=this._classesToPreserve,n=(e.getAttribute("class")||"").split(/\s+/).filter((function(e){return-1!=t.indexOf(e)})).join(" ");for(n?e.setAttribute("class",n):e.removeAttribute("class"),e=e.firstElementChild;e;e=e.nextElementSibling)this._cleanClasses(e)},_fixRelativeUris:function(e){var t=this._doc.baseURI,n=this._doc.documentURI;function i(e){if(t==n&&"#"==e.charAt(0))return e;try{return new URL(e,t).href}catch{}return e}var a=this._getAllNodesWithTag(e,["a"]);this._forEachNode(a,(function(e){var t=e.getAttribute("href");if(t)if(0===t.indexOf("javascript:")){var n=this._doc.createTextNode(e.textContent);e.parentNode.replaceChild(n,e)}else e.setAttribute("href",i(t))}));var o=this._getAllNodesWithTag(e,["img"]);this._forEachNode(o,(function(e){var t=e.getAttribute("src");t&&e.setAttribute("src",i(t))}))},_getArticleTitle:function(){var e=this._doc,t="",n="";try{"string"!=typeof(t=n=e.title.trim())&&(t=n=this._getInnerText(e.getElementsByTagName("title")[0]))}catch{}var i=!1;function a(e){return e.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(t))i=/ [\\\/>»] /.test(t),a(t=n.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"))<3&&(t=n.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(-1!==t.indexOf(": ")){var o=this._concatNodeLists(e.getElementsByTagName("h1"),e.getElementsByTagName("h2")),l=t.trim();this._someNode(o,(function(e){return e.textContent.trim()===l}))||(a(t=n.substring(n.lastIndexOf(":")+1))<3?t=n.substring(n.indexOf(":")+1):a(n.substr(0,n.indexOf(":")))>5&&(t=n))}else if(t.length>150||t.length<15){var r=e.getElementsByTagName("h1");1===r.length&&(t=this._getInnerText(r[0]))}var s=a(t=t.trim().replace(this.REGEXPS.normalize," "));return s<=4&&(!i||s!=a(n.replace(/[\|\-\\\/>»]+/g,""))-1)&&(t=n),t},_prepDocument:function(){var e=this._doc;this._removeNodes(e.getElementsByTagName("style")),e.body&&this._replaceBrs(e.body),this._replaceNodeTags(e.getElementsByTagName("font"),"SPAN")},_nextElement:function(e){for(var t=e;t&&t.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(t.textContent);)t=t.nextSibling;return t},_replaceBrs:function(e){this._forEachNode(this._getAllNodesWithTag(e,["br"]),(function(e){for(var t=e.nextSibling,n=!1;(t=this._nextElement(t))&&"BR"==t.tagName;){n=!0;var i=t.nextSibling;t.parentNode.removeChild(t),t=i}if(n){var a=this._doc.createElement("p");for(e.parentNode.replaceChild(a,e),t=a.nextSibling;t;){if("BR"==t.tagName){var o=this._nextElement(t.nextSibling);if(o&&"BR"==o.tagName)break}if(!this._isPhrasingContent(t))break;var l=t.nextSibling;a.appendChild(t),t=l}for(;a.lastChild&&this._isWhitespace(a.lastChild);)a.removeChild(a.lastChild);"P"===a.parentNode.tagName&&this._setNodeTag(a.parentNode,"DIV")}}))},_setNodeTag:function(e,t){if(this.log("_setNodeTag",e,t),e.__JSDOMParser__)return e.localName=t.toLowerCase(),e.tagName=t.toUpperCase(),e;for(var n=e.ownerDocument.createElement(t);e.firstChild;)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e),e.readability&&(n.readability=e.readability);for(var i=0;i<e.attributes.length;i++)try{n.setAttribute(e.attributes[i].name,e.attributes[i].value)}catch{}return n},_prepArticle:function(e){this._cleanStyles(e),this._markDataTables(e),this._cleanConditionally(e,"form"),this._cleanConditionally(e,"fieldset"),this._clean(e,"object"),this._clean(e,"embed"),this._clean(e,"h1"),this._clean(e,"footer"),this._clean(e,"link"),this._clean(e,"aside"),this._forEachNode(e.children,(function(e){this._cleanMatchedNodes(e,/share/)}));var t=e.getElementsByTagName("h2");if(1===t.length){var n=(t[0].textContent.length-this._articleTitle.length)/this._articleTitle.length;Math.abs(n)<.5&&(n>0?t[0].textContent.includes(this._articleTitle):this._articleTitle.includes(t[0].textContent))&&this._clean(e,"h2")}this._clean(e,"iframe"),this._clean(e,"input"),this._clean(e,"textarea"),this._clean(e,"select"),this._clean(e,"button"),this._cleanHeaders(e),this._cleanConditionally(e,"table"),this._cleanConditionally(e,"ul"),this._cleanConditionally(e,"div"),this._removeNodes(e.getElementsByTagName("p"),(function(e){return 0===e.getElementsByTagName("img").length+e.getElementsByTagName("embed").length+e.getElementsByTagName("object").length+e.getElementsByTagName("iframe").length&&!this._getInnerText(e,!1)})),this._forEachNode(this._getAllNodesWithTag(e,["br"]),(function(e){var t=this._nextElement(e.nextSibling);t&&"P"==t.tagName&&e.parentNode.removeChild(e)})),this._forEachNode(this._getAllNodesWithTag(e,["table"]),(function(e){var t=this._hasSingleTagInsideElement(e,"TBODY")?e.firstElementChild:e;if(this._hasSingleTagInsideElement(t,"TR")){var n=t.firstElementChild;if(this._hasSingleTagInsideElement(n,"TD")){var i=n.firstElementChild;i=this._setNodeTag(i,this._everyNode(i.childNodes,this._isPhrasingContent)?"P":"DIV"),e.parentNode.replaceChild(i,e)}}}))},_initializeNode:function(e){switch(e.readability={contentScore:0},e.tagName){case"DIV":e.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":e.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":e.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":e.readability.contentScore-=5}e.readability.contentScore+=this._getClassWeight(e)},_removeAndGetNext:function(e){var t=this._getNextNode(e,!0);return e.parentNode.removeChild(e),t},_getNextNode:function(e,t){if(!t&&e.firstElementChild)return e.firstElementChild;if(e.nextElementSibling)return e.nextElementSibling;do{e=e.parentNode}while(e&&!e.nextElementSibling);return e&&e.nextElementSibling},_checkByline:function(e,t){if(this._articleByline)return!1;if(void 0!==e.getAttribute)var n=e.getAttribute("rel");return!("author"!==n&&!this.REGEXPS.byline.test(t)||!this._isValidByline(e.textContent)||(this._articleByline=e.textContent.trim(),0))},_getNodeAncestors:function(e,t){t=t||0;for(var n=0,i=[];e.parentNode&&(i.push(e.parentNode),!t||++n!==t);)e=e.parentNode;return i},_grabArticle:function(){this.log("**** grabArticle ****");for(var e=this._doc,t=this._doc.body,n=t.innerHTML;;){for(var i=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),a=[],o=this._doc.documentElement;o;){var l=o.className+" "+o.id;if(this._isProbablyVisible(o))if(this._checkByline(o,l))o=this._removeAndGetNext(o);else if(i&&this.REGEXPS.unlikelyCandidates.test(l)&&!this.REGEXPS.okMaybeItsACandidate.test(l)&&"BODY"!==o.tagName&&"A"!==o.tagName)this.log("Removing unlikely candidate - "+l),o=this._removeAndGetNext(o);else if("DIV"!==o.tagName&&"SECTION"!==o.tagName&&"HEADER"!==o.tagName&&"H1"!==o.tagName&&"H2"!==o.tagName&&"H3"!==o.tagName&&"H4"!==o.tagName&&"H5"!==o.tagName&&"H6"!==o.tagName||!this._isElementWithoutContent(o)){if(-1!==this.DEFAULT_TAGS_TO_SCORE.indexOf(o.tagName)&&a.push(o),"DIV"===o.tagName){for(var r=null,s=o.firstChild;s;){var d=s.nextSibling;if(this._isPhrasingContent(s))null!==r?r.appendChild(s):this._isWhitespace(s)||(r=e.createElement("p"),o.replaceChild(r,s),r.appendChild(s));else if(null!==r){for(;r.lastChild&&this._isWhitespace(r.lastChild);)r.removeChild(r.lastChild);r=null}s=d}if(this._hasSingleTagInsideElement(o,"P")&&this._getLinkDensity(o)<.25){var c=o.children[0];o.parentNode.replaceChild(c,o),o=c,a.push(o)}else this._hasChildBlockElement(o)||(o=this._setNodeTag(o,"P"),a.push(o))}o=this._getNextNode(o)}else o=this._removeAndGetNext(o);else this.log("Removing hidden node - "+l),o=this._removeAndGetNext(o)}var h=[];this._forEachNode(a,(function(e){if(e.parentNode&&void 0!==e.parentNode.tagName){var t=this._getInnerText(e);if(!(t.length<25)){var n=this._getNodeAncestors(e,3);if(0!==n.length){var i=0;i+=1,i+=t.split(",").length,i+=Math.min(Math.floor(t.length/100),3),this._forEachNode(n,(function(e,t){if(e.tagName&&e.parentNode&&void 0!==e.parentNode.tagName){if(void 0===e.readability&&(this._initializeNode(e),h.push(e)),0===t)var n=1;else n=1===t?2:3*t;e.readability.contentScore+=i/n}}))}}}}));for(var u=[],p=0,g=h.length;p<g;p+=1){var m=h[p],f=m.readability.contentScore*(1-this._getLinkDensity(m));m.readability.contentScore=f,this.log("Candidate:",m,"with score "+f);for(var v=0;v<this._nbTopCandidates;v++){var y=u[v];if(!y||f>y.readability.contentScore){u.splice(v,0,m),u.length>this._nbTopCandidates&&u.pop();break}}}var E,_=u[0]||null,b=!1;if(null===_||"BODY"===_.tagName){_=e.createElement("DIV"),b=!0;for(var T=t.childNodes;T.length;)this.log("Moving child out:",T[0]),_.appendChild(T[0]);t.appendChild(_),this._initializeNode(_)}else if(_){for(var N=[],x=1;x<u.length;x++)u[x].readability.contentScore/_.readability.contentScore>=.75&&N.push(this._getNodeAncestors(u[x]));if(N.length>=3)for(E=_.parentNode;"BODY"!==E.tagName;){for(var A=0,w=0;w<N.length&&A<3;w++)A+=Number(N[w].includes(E));if(A>=3){_=E;break}E=E.parentNode}_.readability||this._initializeNode(_),E=_.parentNode;for(var C=_.readability.contentScore,S=C/3;"BODY"!==E.tagName;)if(E.readability){var L=E.readability.contentScore;if(L<S)break;if(L>C){_=E;break}C=E.readability.contentScore,E=E.parentNode}else E=E.parentNode;for(E=_.parentNode;"BODY"!=E.tagName&&1==E.children.length;)E=(_=E).parentNode;_.readability||this._initializeNode(_)}for(var I=e.createElement("DIV"),D=Math.max(10,.2*_.readability.contentScore),k=(E=_.parentNode).children,B=0,P=k.length;B<P;B++){var R=k[B],O=!1;if(this.log("Looking at sibling node:",R,R.readability?"with score "+R.readability.contentScore:""),this.log("Sibling has score",R.readability?R.readability.contentScore:"Unknown"),R===_)O=!0;else{var M=0;if(R.className===_.className&&""!==_.className&&(M+=.2*_.readability.contentScore),R.readability&&R.readability.contentScore+M>=D)O=!0;else if("P"===R.nodeName){var G=this._getLinkDensity(R),W=this._getInnerText(R),F=W.length;(F>80&&G<.25||F<80&&F>0&&0===G&&-1!==W.search(/\.( |$)/))&&(O=!0)}}O&&(this.log("Appending node:",R),-1===this.ALTER_TO_DIV_EXCEPTIONS.indexOf(R.nodeName)&&(this.log("Altering sibling:",R,"to div."),R=this._setNodeTag(R,"DIV")),I.appendChild(R),B-=1,P-=1)}if(this._debug&&this.log("Article content pre-prep: "+I.innerHTML),this._prepArticle(I),this._debug&&this.log("Article content post-prep: "+I.innerHTML),b)_.id="read-page-1",_.className="page";else{var H=e.createElement("DIV");H.id="read-page-1",H.className="page";for(var U=I.childNodes;U.length;)H.appendChild(U[0]);I.appendChild(H)}this._debug&&this.log("Article content after paging: "+I.innerHTML);var V=!0,X=this._getInnerText(I,!0).length;if(X<this._charThreshold)if(V=!1,t.innerHTML=n,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS),this._attempts.push({articleContent:I,textLength:X});else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES),this._attempts.push({articleContent:I,textLength:X});else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY),this._attempts.push({articleContent:I,textLength:X});else{if(this._attempts.push({articleContent:I,textLength:X}),this._attempts.sort((function(e,t){return t.textLength-e.textLength})),!this._attempts[0].textLength)return null;I=this._attempts[0].articleContent,V=!0}if(V){var j=[E,_].concat(this._getNodeAncestors(E));return this._someNode(j,(function(e){if(!e.tagName)return!1;var t=e.getAttribute("dir");return!!t&&(this._articleDir=t,!0)})),void 0===this.topCandidate&&(this.topCandidateUid=_.getAttribute("data-wv-uid")),I}}},_isValidByline:function(e){return("string"==typeof e||e instanceof String)&&(e=e.trim()).length>0&&e.length<100},_getArticleMetadata:function(){var e={},t={},n=this._doc.getElementsByTagName("meta"),i=/\s*(dc|dcterm|og|twitter)\s*:\s*(author|creator|description|title|site_name)\s*/gi,a=/^\s*(?:(dc|dcterm|og|twitter|weibo:(article|webpage))\s*[\.:]\s*)?(author|creator|description|title|site_name)\s*$/i;return this._forEachNode(n,(function(e){var n=e.getAttribute("name"),o=e.getAttribute("property"),l=e.getAttribute("content"),r=null,s=null;if(o&&(r=o.match(i)))for(var d=r.length-1;d>=0;d--)s=r[d].toLowerCase().replace(/\s/g,""),t[s]=l.trim();!r&&n&&a.test(n)&&(s=n,l&&(s=s.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),t[s]=l.trim()))})),e.title=t["dc:title"]||t["dcterm:title"]||t["og:title"]||t["weibo:article:title"]||t["weibo:webpage:title"]||t.title||t["twitter:title"],e.title||(e.title=this._getArticleTitle()),e.byline=t["dc:creator"]||t["dcterm:creator"]||t.author,e.excerpt=t["dc:description"]||t["dcterm:description"]||t["og:description"]||t["weibo:article:description"]||t["weibo:webpage:description"]||t.description||t["twitter:description"],e.siteName=t["og:site_name"],e},_removeScripts:function(e){this._removeNodes(e.getElementsByTagName("script"),(function(e){return e.nodeValue="",e.removeAttribute("src"),!0})),this._removeNodes(e.getElementsByTagName("noscript"))},_hasSingleTagInsideElement:function(e,t){return 1==e.children.length&&e.children[0].tagName===t&&!this._someNode(e.childNodes,(function(e){return e.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(e.textContent)}))},_isElementWithoutContent:function(e){return e.nodeType===this.ELEMENT_NODE&&0==e.textContent.trim().length&&(0==e.children.length||e.children.length==e.getElementsByTagName("br").length+e.getElementsByTagName("hr").length)},_hasChildBlockElement:function(e){return this._someNode(e.childNodes,(function(e){return-1!==this.DIV_TO_P_ELEMS.indexOf(e.tagName)||this._hasChildBlockElement(e)}))},_isPhrasingContent:function(e){return e.nodeType===this.TEXT_NODE||-1!==this.PHRASING_ELEMS.indexOf(e.tagName)||("A"===e.tagName||"DEL"===e.tagName||"INS"===e.tagName)&&this._everyNode(e.childNodes,this._isPhrasingContent)},_isWhitespace:function(e){return e.nodeType===this.TEXT_NODE&&0===e.textContent.trim().length||e.nodeType===this.ELEMENT_NODE&&"BR"===e.tagName},_getInnerText:function(e,t){t=void 0===t||t;var n=e.textContent.trim();return t?n.replace(this.REGEXPS.normalize," "):n},_getCharCount:function(e,t){return t=t||",",this._getInnerText(e).split(t).length-1},_cleanStyles:function(e){if(e&&"svg"!==e.tagName.toLowerCase()){for(var t=0;t<this.PRESENTATIONAL_ATTRIBUTES.length;t++)e.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[t]);-1!==this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.indexOf(e.tagName)&&(e.removeAttribute("width"),e.removeAttribute("height"));for(var n=e.firstElementChild;null!==n;)this._cleanStyles(n),n=n.nextElementSibling}},_getLinkDensity:function(e){var t=this._getInnerText(e).length;if(0===t)return 0;var n=0;return this._forEachNode(e.getElementsByTagName("a"),(function(e){n+=this._getInnerText(e).length})),n/t},_getClassWeight:function(e){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var t=0;return"string"==typeof e.className&&""!==e.className&&(this.REGEXPS.negative.test(e.className)&&(t-=25),this.REGEXPS.positive.test(e.className)&&(t+=25)),"string"==typeof e.id&&""!==e.id&&(this.REGEXPS.negative.test(e.id)&&(t-=25),this.REGEXPS.positive.test(e.id)&&(t+=25)),t},_clean:function(e,t){var n=-1!==["object","embed","iframe"].indexOf(t);this._removeNodes(e.getElementsByTagName(t),(function(e){if(n){var t=[].map.call(e.attributes,(function(e){return e.value})).join("|");if(this.REGEXPS.videos.test(t))return!1;if(this.REGEXPS.videos.test(e.innerHTML))return!1}return!0}))},_hasAncestorTag:function(e,t,n,i){n=n||3,t=t.toUpperCase();for(var a=0;e.parentNode;){if(n>0&&a>n)return!1;if(e.parentNode.tagName===t&&(!i||i(e.parentNode)))return!0;e=e.parentNode,a++}return!1},_getRowAndColumnCount:function(e){for(var t=0,n=0,i=e.getElementsByTagName("tr"),a=0;a<i.length;a++){var o=i[a].getAttribute("rowspan")||0;o&&(o=parseInt(o,10)),t+=o||1;for(var l=0,r=i[a].getElementsByTagName("td"),s=0;s<r.length;s++){var d=r[s].getAttribute("colspan")||0;d&&(d=parseInt(d,10)),l+=d||1}n=Math.max(n,l)}return{rows:t,columns:n}},_markDataTables:function(e){for(var t=e.getElementsByTagName("table"),n=0;n<t.length;n++){var i=t[n];if("presentation"!=i.getAttribute("role"))if("0"!=i.getAttribute("datatable"))if(i.getAttribute("summary"))i._readabilityDataTable=!0;else{var a=i.getElementsByTagName("caption")[0];if(a&&a.childNodes.length>0)i._readabilityDataTable=!0;else if(["col","colgroup","tfoot","thead","th"].some((function(e){return!!i.getElementsByTagName(e)[0]})))this.log("Data table because found data-y descendant"),i._readabilityDataTable=!0;else if(i.getElementsByTagName("table")[0])i._readabilityDataTable=!1;else{var o=this._getRowAndColumnCount(i);o.rows>=10||o.columns>4?i._readabilityDataTable=!0:i._readabilityDataTable=o.rows*o.columns>10}}else i._readabilityDataTable=!1;else i._readabilityDataTable=!1}},_cleanConditionally:function(e,t){if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)){var n="ul"===t||"ol"===t;this._removeNodes(e.getElementsByTagName(t),(function(e){if(this._hasAncestorTag(e,"table",-1,(function(e){return e._readabilityDataTable})))return!1;var t=this._getClassWeight(e);if(this.log("Cleaning Conditionally",e),t+0<0)return!0;if(this._getCharCount(e,",")<10){for(var i=e.getElementsByTagName("p").length,a=e.getElementsByTagName("img").length,o=e.getElementsByTagName("li").length-100,l=e.getElementsByTagName("input").length,r=0,s=e.getElementsByTagName("embed"),d=0,c=s.length;d<c;d+=1)this.REGEXPS.videos.test(s[d].src)||(r+=1);var h=this._getLinkDensity(e),u=this._getInnerText(e).length;return a>1&&i/a<.5&&!this._hasAncestorTag(e,"figure")||!n&&o>i||l>Math.floor(i/3)||!n&&u<25&&(0===a||a>2)&&!this._hasAncestorTag(e,"figure")||!n&&t<25&&h>.2||t>=25&&h>.5||1===r&&u<75||r>1}return!1}))}},_cleanMatchedNodes:function(e,t){for(var n=this._getNextNode(e,!0),i=this._getNextNode(e);i&&i!=n;)i=t.test(i.className+" "+i.id)?this._removeAndGetNext(i):this._getNextNode(i)},_cleanHeaders:function(e){for(var t=1;t<3;t+=1)this._removeNodes(e.getElementsByTagName("h"+t),(function(e){return this._getClassWeight(e)<0}))},_flagIsActive:function(e){return(this._flags&e)>0},_removeFlag:function(e){this._flags=this._flags&~e},_isProbablyVisible:function(e){return!(e.style&&"none"==e.style.display||e.hasAttribute("hidden"))},parse:function(){if(this._maxElemsToParse>0){var e=this._doc.getElementsByTagName("*").length;if(e>this._maxElemsToParse)throw new Error("Aborting parsing document; "+e+" elements found")}this._removeScripts(this._doc),this._prepDocument();var t=this._getArticleMetadata();this._articleTitle=t.title;var n=this._grabArticle();if(!n)return null;if(this.log("Grabbed: "+n.innerHTML),this._postProcessContent(n),!t.excerpt){var i=n.getElementsByTagName("p");i.length>0&&(t.excerpt=i[0].textContent.trim())}var a=n.textContent.trim();return{title:this._articleTitle,byline:t.byline||this._articleByline,dir:this._articleDir,content:n.innerHTML,textContent:a,length:a.length,excerpt:t.excerpt,siteName:t.siteName||this._articleSiteName}}};const B=document;class P extends h{constructor(){super(),this.playing=!1}setPlaying(e){this.playing=e}isPlaying(){return this.playing}stop(){this.emit("stop")}start(){this.emit("start")}play(){this.emit("play")}pause(){this.emit("pause")}reload(){this.emit("reload")}debug(){B.cookie="wv-debug=true",B.location.reload()}}const R=document,O=window,M="true"==="[trial_not_expired]|".replace("|",""),G=[""].filter(Boolean),W=["img","a","u","br","strong","meta","em","span","svg","path","table","tbody","tr","td","i","input","polygon","form","progress","textarea","aside","time","link","script","noscript","iframe","figure","style","feGaussianBlur","filter","fieldset","legend","audio","video","code"];var F;function H(e){const t=null===e.offsetParent;if(t&&null!==e.nextElementSibling)return H(e.nextElementSibling);if(!t&&e.children.length>0)return H(e.children[0]);if(!t&&Node.ELEMENT_NODE===e.nodeType&&!X(e.tagName))return e;do{e=e.parentNode}while(X(e.tagName));return e}function U(e,t,n){let i=null;for(let a=0;a<e.length;a++){const o=e[a];if(Node.ELEMENT_NODE===o.nodeType&&!X(o.tagName)&&F!==o.innerText&&o.innerText.substring(0,n)===t&&!V(o)){i=H(o);break}}return i}function V(e){return!!X(e.parentNode.tagName)||"body"!==e.parentNode.tagName.toLowerCase()&&V(e.parentNode)}function X(e){return W.indexOf(e.toLowerCase())>-1}new class{constructor(){if(F!==O.wvWidget)return console.log("WebsiteVoice already loaded. Make sure you only add the script once per page.");O.wvWidget={},this.loadWidget()}loadWidget(){const e=this;let t=1e3;if(F===O.wvData||F===R.body||null===R.body||"complete"!==R.readyState)return setTimeout(e.loadWidget.bind(e),100);e.isDisabled()||e.isUrlDisabled()||(e.isDevelopment=O.wvData.development||!1,O.wvWidget=new P,O.wvWidget.on("reload",i(e.reloadWidget,e)),e.loadCSS(),e.detectElements(),0===e.elements.length&&(c("No elements found to add voice"),F!==O.wvData.id&&"WV_SITE_ID"===O.wvData.id&&s("No elements found. Please try adding a CSS selector in your WebsiteVoice dashboard or contact us."),t=7e3),e.loadAudioElement(),e.player=new D({package:"[package]",trialNotExpired:M}),e.loadWidgets(),setInterval(i(e.ajaxCheck,e),t),F!==O.wvData.onWidgetLoad&&O.wvData.onWidgetLoad())}reloadWidget(){const e=this;for(let t=0;t<e.widgets.length;t++)e.player.unsubscribeFromWidget(e.widgets[t]),e.widgets[t].unload();if(delete e.text,e.widgets=[],e.player.reload(),e.detectElements(),0===e.elements.length)return c("No elements found to add voice");e.loadWidgets()}isDisabled(){return R.body.className.indexOf("wv-disable")>-1}isUrlDisabled(){return G.some((e=>e.endsWith("*")?R.location.href.includes(e.split("*")[0]):R.location.href===e))}loadCSS(){const e=R.createElement("link");e.rel="stylesheet",e.charset="utf-8",e.media="screen",e.type="text/css",this.isDevelopment?e.href="http://"+R.location.host+"/assets/css/websitevoice.css?"+Math.floor(1e3*Math.random()):e.href="https://widget.websitevoice.com/wv.css?9375",R.head.appendChild(e)}detectElements(){let e=R.querySelectorAll('[data-wv="true"]');0===e.length&&(e=this.autodetectArticle()),this.elements=e}autodetectArticle(){const e="article, .post-content, .blog-body, .post_content, .content, .section",t=O.wvData["text-selector"]||e,n=t.split(",").map((e=>e.trim())),i=[];if(F===O.wvData["text-selector"]||e===O.wvData["text-selector"]){c("v 2.0");const e=[],t=R.querySelectorAll("body *"),n=new k(R.cloneNode(!0)).parse();let i,a=n.textContent.substring(0,50);if(i=U(t,a,50),null===i&&(a=a.substring(0,20),i=U(t,a,20)),null!==i&&e.push(i),e.length>0)return this.text=n.textContent,c(e[0]),c(this.text),e;c("No text found, fallback to old")}for(let a=0;a<n.length;a++){let o=R.querySelectorAll(n[a]);if(o.length>0&&e===t)return o;o.length>0&&Array.prototype.push.apply(i,o)}if(i.length>0)return i;for(let a=0;a<n.length;a++){const o=n[a];if("."===o[0]||"#"===o[0])continue;let l=R.querySelectorAll("."+o);if(l.length>0&&e===t)return l;l.length>0&&Array.prototype.push.apply(i,l)}return i}loadAudioElement(){const e=R.createElement("audio"),t=R.createElement("audio");e.id="wv-audio",t.id="wv-preload-audio",t.preload="auto",e.style.display="none",t.style.display="none",R.body.appendChild(e),R.body.appendChild(t),this.audioElement=e,this.preloadElement=t}loadWidgets(){const e=this;e.widgets=[];for(const t of e.elements){const n={element:t,audioElement:e.audioElement,preloadElement:e.preloadElement,isDevelopment:e.isDevelopment,text:e.text};e.elements.length>1&&(n.appendButtonText=e.widgets.length+1);const i=new b(n);e.widgets.push(i),e.player.subscribeToWidget(i)}}ajaxCheck(){null===R.querySelector(".wv-wrapper, .wv-wrapper-button")&&this.reloadWidget()}}}},t={};!function n(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}(120)})();